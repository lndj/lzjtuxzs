<include file="Public:header" title="小助手后台管理" />

  <!-- sidebar start -->
<include file="Public:siderbar"/>
  <!-- sidebar end -->

<!-- content start -->
<div class="admin-content">

    <div class="am-cf am-padding">
      <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">首页</strong> / <small>数据统计</small></div>
    </div>

    <ul class="am-avg-sm-1 am-avg-md-4 am-margin am-padding am-text-center admin-content-list ">
      <li><a href="#" class="am-text-success"><span class="am-icon-btn am-icon-file-text"></span><br/>今日绑定<br/>{$today_bind}</a></li>
      <li><a href="#" class="am-text-warning"><span class="am-icon-btn am-icon-briefcase"></span><br/>绑定人数<br/>{$bind_user_num}</a></li>
      <li><a href="#" class="am-text-danger"><span class="am-icon-btn am-icon-recycle"></span><br/>解绑人数<br/>{$bind_out_user_num}</a></li>
      <li><a href="#" class="am-text-secondary"><span class="am-icon-btn am-icon-user-md"></span><br/>资料获取人数<br/>{$all_user_num}</a></li>
    </ul>


    <div class="am-g">

        <div class="am-u-md-12">
            <div class="am-panel am-panel-default">
                <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-2'}"> 服务访问数量图表 / Chart <span class="am-icon-chevron-down am-fr" ></span></div>
                <div id="collapse-panel-2" class="am-in">
                    <div id="counter_statistics" style="height: 400px;"></div>
                </div>
            </div>
        </div>

        <div class="am-u-md-6">
            <div class="am-panel am-panel-default">
                <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-user_grade_level'}"> 用户年级分布（昨日） <span class="am-icon-chevron-down am-fr" ></span></div>
                <div id="collapse-panel-user_grade_level" class="am-in">
                    <div id="user_grade_level" style="height: 400px;"></div>
                </div>
            </div>
        </div>

        <div class="am-u-md-6">
            <div class="am-panel am-panel-default">
                <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-user_sex'}"> 用户男女比例 <span class="am-icon-chevron-down am-fr" ></span></div>
                <div id="collapse-panel-user_sex" class="am-in">
                    <div id="user_sex" style="height: 400px;"></div>
                </div>
            </div>
        </div>

        <div class="am-u-md-6">
            <div class="am-panel am-panel-default">
              <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-3'}">教务查询调用数量<span class="am-icon-chevron-down am-fr" ></span></div>
              <div id="collapse-panel-3" class="am-in">
                <table class="am-table am-table-bd am-table-bdrs am-table-striped am-table-hover">
                  <tbody>
                  <tr>
                    <th class="am-text-center">key</th>
                    <th>备注</th>
                    <th>访问量</th>
                  </tr>
                  <tr>
                    <td class="am-text-center">grade_wechat</td>
                    <td>成绩查询次数</td>
                    <td>{$grade_wechat}</td>
                  </tr>
                  <tr>
                    <td class="am-text-center">update_grade</td>
                    <td>更新成绩</td>
                    <td>{$update_grade}</td>
                  </tr>
                  <tr>
                    <td class="am-text-center">update_exam</td>
                    <td>更新考试</td>
                    <td>{$update_exam}</td>
                  </tr>
                  <tr>
                    <td class="am-text-center">schedule_click</td>
                    <td>课表查询（菜单）</td>
                    <td>{$schedule_click}</td>
                  </tr>
                  <tr>
                    <td class="am-text-center">schedule_text</td>
                    <td>课表查询（关键词）</td>
                    <td>{$schedule_text}</td>
                  </tr>
                  <tr>
                    <td class="am-text-center">free_classroom</td>
                    <td>空闲教室查询</td>
                    <td>{$free_classroom}</td>
                  </tr>
                  <tr>
                    <td class="am-text-center">exam_wechat</td>
                    <td>考试安排查询</td>
                    <td>{$exam_wechat}</td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </div>
      </div>

      <div class="am-u-md-6">

        <div class="am-panel am-panel-default">
          <div class="am-panel-hd am-cf" data-am-collapse="{target: '#collapse-panel-4'}"> Web访问次数 <span class="am-icon-chevron-down am-fr" ></span></div>
          <div id="collapse-panel-4" class="am-in">
              <table class="am-table am-table-bd am-table-bdrs am-table-striped am-table-hover">
                  <tbody>
                      <tr>
                          <th class="am-text-center">key</th>
                          <th>备注</th>
                          <th>访问量</th>
                      </tr>
                      <tr>
                          <td class="am-text-center">help_page</td>
                          <td>帮助页面</td>
                          <td>{$help_page}</td>
                      </tr>
                      <tr>
                          <td class="am-text-center">web_grade</td>
                          <td>Web成绩查询</td>
                          <td>{$web_grade}</td>
                      </tr>
                  </tbody>
              </table>
          </div>
        </div>
    </div>

  </div>

</div>

<!--回到顶部-->
<div data-am-widget="gotop" class="am-gotop am-gotop-fixed" >
    <a href="#top" title="">
        <i class="am-gotop-icon am-icon-arrow-up am-active"></i>
    </a>
</div>

<!--<script src="http://echarts.baidu.com/build/dist/echarts.js"></script>-->
<script src="http://echarts.baidu.com/build/dist/echarts-all.js"></script>
<script type="text/javascript">
    var counter_statistics = echarts.init(document.getElementById('counter_statistics'));

    /*myChart.showLoading({
                    text: '正在努力的读取数据中...',    //loading话术
                });
                 ajax getting data...............

                 ajax callback
                myChart.hideLoading();*/
    var option = {
        tooltip: {
            show: true
        },
        legend: {
            data:['调用量']
        },
        xAxis : [
            {
                type : 'category',
                data : ["成绩","更新成绩","更新考试","课表（菜单）","课表（关键词）","空闲教室","考试安排"]
            }
        ],
        yAxis : [
            {
                type : 'value'
            }
        ],
        series : [
            {
                "name":"调用量",
                "type":"bar",
                "data":[{$grade_wechat}, {$update_grade}, {$update_exam}, {$schedule_click}, {$schedule_text}, {$free_classroom}, {$exam_wechat}]
            }
        ],
        grid : [
            {
                "x2" : 0,
                "y2" : 0,
            }
        ],
        toolbox: {
            show : true,
            orient: 'vertical',      // 布局方式，默认为水平布局，可选为：
            // 'horizontal' ¦ 'vertical'
            x: 'right',                // 水平安放位置，默认为全图右对齐，可选为：
                                       // 'center' ¦ 'left' ¦ 'right'
                                       // ¦ {number}（x坐标，单位px）
            y: 'top',                  // 垂直安放位置，默认为全图顶端，可选为：
                                       // 'top' ¦ 'bottom' ¦ 'center'
                                       // ¦ {number}（y坐标，单位px）
            color : ['#1e90ff','#22bb22','#4b0082','#d2691e'],
            backgroundColor: 'rgba(0,0,0,0)', // 工具箱背景颜色
            borderColor: '#ccc',       // 工具箱边框颜色
            borderWidth: 0,            // 工具箱边框线宽，单位px，默认为0（无边框）
            padding: 2,                // 工具箱内边距，单位px，默认各方向内边距为5，
            showTitle: true,
            feature : {

                saveAsImage : {
                    show : true,
                    title : '保存为图片',
                    type : 'jpeg',
                    lang : ['点击本地保存']
                }
            }
        },
        calculable : true,
//                    dataZoom : {
//                        show : true,
//                        realtime : true,
//                        start : 0,
//                        end : 100
//                    },

    };

    // 为echarts对象加载数据
    counter_statistics.setOption(option);


    var myChart_grade_level = echarts.init(document.getElementById('user_grade_level'));

    var option = {
        title: {
            text: "用户年级分布",
                    subtext: "每日凌晨0点更新数据",
                    x: "center"
        },
        tooltip: {
            trigger: "item",
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient: "vertical",
                    x: "left",
                    data: [{$js_legend_str}]
        },
        toolbox: {
            show: true,
                    feature: {
                dataView: {
                    readOnly: true,
                            show: true
                },
                restore: {
                    show: true
                },
                saveAsImage: {
                    show: true
                }
            }
        },
        calculable: true,
                series: [
        {
            name: "年级分布",
            type: "pie",
            radius: "58%",
            center: ["56%", "60%"],
            data: [
                {$js_data_str}
            ],
            markPoint: {
                data: []
            },
            itemStyle: {
                emphasis: {
                    borderColor: "rgb(252, 244, 244)",
                    label: {
                        show: false
                    }
                }
            },
            selectedMode: "single"
        }
    ],
            animation: true,
            animationEasing: "ExponentialOut"
    };
    // 为echarts对象加载数据
    myChart_grade_level.setOption(option);

    var myChart_user_sex = echarts.init(document.getElementById('user_sex'));

    var option = {
        title: {
            text: "用户性别比例",
            subtext: "数据来源于已绑定用户",
            x: "center"
        },
        tooltip: {
            trigger: "item",
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient: "vertical",
            x: "left",
            data: ['男生','女生','未知']
        },
        toolbox: {
            show: true,
            feature: {
                dataView: {
                    readOnly: true,
                    show: true
                },
                restore: {
                    show: true
                },
                saveAsImage: {
                    show: true
                }
            }
        },
        calculable: true,
        series: [
            {
                name: "性别比例",
                type: "pie",
                radius: "65%",
                center: ["50%", "60%"],
                data: [
                    {value:{$boy},name:"男生"},{value:{$girl},name:"女生"},{value:{$sex_unkown},name:"未知"},
                ],
                markPoint: {
                    data: []
                },
                itemStyle: {
                    emphasis: {
                        borderColor: "rgb(252, 244, 244)",
                        label: {
                            show: false
                        }
                    }
                },
                selectedMode: "single"
            }
        ],
        animation: true,
        animationEasing: "ExponentialOut"
    };
    // 为echarts对象加载数据
    myChart_user_sex.setOption(option);

</script>


  <!-- content end -->
<include file="Public:footer" />
